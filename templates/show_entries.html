{% extends "layout.html" %}
{% block body %}
{% if session.logged_in %}
<script type="text/javascript">
  function del(id, pw) {
  var answer = prompt("password");
  if (answer == pw)
  location.href='/del?id='+id;
  }
  function cDel(id) {
  var password = prompt("password")
  document.getElementById(id).value = password
  }
</script>
<ul class=entries>
  {% for entry in entries %}
  <dl><form action="{{ url_for('edit_entry',id=entry.id) }}" method=post class=edit-entry>
	  <dt>Title:</dt>
	  <dd><input type=text name=title value={{ entry.title }}></dd>
	  <dt>Text:</dt>
	  <dd><input type=text name=text value={{ entry.text|safe }}></dd>
	  <dt>Password:</dt>
	  <dd><input type=text name=entryPassword size=5></dd>
	  <input type=button value=Delete onclick='del({{ entry.id|tojson|safe }}, {{ entry.password|tojson|safe }})'>
	  <input type=submit value=Edit>
	</form></dl>
	{% for content in contents %}
	<dl><form action="{{ url_for('del_comment', id=entry.id, id2=content.id) }}" method=post class=del-comment>
		<dt>Author: {{ content.author }}</dt>
		<dt>Comment: {{ content.comment }}
		  <input type=hidden name=commentPassword id={{ content.id }}>
		  <input type=submit value=Delete onclick='cDel({{ content.id }})'></dt></dl></form>
	{% endfor %}
  <dl><form action="{{ url_for('add_comment', id=entry.id) }}" method=post class=add-comment>
	  <dt>Author: </dt>
	  <dd><input type=text size=10 name=author></dd>
	  <dt>Comment: </dt>
	  <dd><textarea name=comment rows=3 cols=20></textarea></dd>
	  <dt>Password: <input type=text size=5 name=password></dt>
	  <dd><input type=submit value=Share></dd>
  </dl> 
  </form>
  {% else %}
  <li><em>Unbelievable. No entries here so far</em></li>
  {% endfor %}
</ul>
{% else %}
you must login first
{% endif %}
{% endblock %}
